import numpy as np
import matplotlib.pyplot as plot
#pos2red

y=[107.178, 117.791, 133.069, 140.813, 104.587, 126.058, 100.11, 133.914, 129.208, 141.884, 94.5568, 137.184, 144.62, 127.477, 166.937, 149.25, 151.857, 149.01, 140.63, 142.156, 198.536, 153.892, 172.334, 169.88, 176.735, 150.95, 199.069, 150.398, 165.244, 181.277, 184.006, 177.923, 218.169, 174.498, 281.416, 189.855, 224.024, 201.853, 245.125, 225.035, 211.314, 251.939, 248.45, 226.039, 241.978, 192.079, 184.999, 264.071, 287.462, 204.644, 207.618, 237.35, 248.245, 218.589, 235.672, 321.38, 332.764, 607.667, 304.769, 347.334, 255.108, 351.202, 263.908, 272.342, 377.38, 255.306, 368.32, 265.622, 418.038, 725.143, 1349.02, 806.564, 4832.79, 1525.55, 286.575, 1084.62, 296.332, 416.01, 496.181, 534.02, 440.629, 3273.72, 340.363, 670.982, 2131.84, 370.32, 1511.93, 7954.35, 3322.04, 3077.72, 3518.71, 1152.71, 846.847, 618.574, 6624.04, 721.393, 2221.17, 2294.85, 1996.2, 1218.34, 421.677, 2018.43, 8969.05, 22405.5, 1083.89, 2107.46, 1438.99, 547.737, 317.662, 1112.79, 6276.01, 5601.44, 13902.4, 15807, 3402.55, 721.891, 1560.55, 606.426, 1115.25, 516.187, 4177.77, 4835.88, 4396.75, 812.939, 19072, 2676.68, 12413.1, 4280.98, 4030.89, 962.249, 2083.66, 2830.86, 9886.28, 12267.9, 2886.32, 6297.98, 3003.3, 9124.17, 1970.28, 3761.29, 7992.2, 868.972, 18698.9, 560.952, 522.077, 1274.85, 576.548, 8893, 708.488, 955.274, 577.536, 13505.1, 10565.9, 3070.1, 6533.78, 4323.49, 1871.24, 660.188, 974.957, 712.971, 7334.82, 4073.96, 16324.9, 18306.2, 909.324, 6012.82, 5895.74, 8150.43, 956.91, 688.613, 1472.77, 7797.16, 862.362, 984.728, 1456.18, 1415.71, 892.884, 13813.2, 16017.7, 14133.5, 13765, 7529.02, 1031.36, 5639.83, 911.79, 5625.94, 25261.1, 43185.5, 988.873, 20972, 12519, 1102.29, 12309, 1468.9, 895.34, 7152.79, 1568.28, 1576.76, 19904.8, 2187.95, 20948.7, 1098.47, 4650.92, 752.268, 587.485, 16571.9, 696.309, 4646.88, 1296.64, 6527.87, 764.007, 10316, 3554.75, 1010.95, 9279.53, 712.16, 748.809, 35477.5, 1385.91, 909.349, 8683.87, 4723.01, 3244.74, 813.727, 1490.18, 674.244, 5406.27, 8044.58, 11603.2, 43860.5, 2717.81, 1605.74, 12823, 1883.85, 1012.61, 757.121, 4820.23, 1376, 971.794, 743.535, 1668.84, 1110.79, 1438.68, 1296.75, 2328.41, 2331.23, 1669.01, 829.718, 11750.8, 888.342, 1525.91, 22958.9, 3206.2, 891.214, 7748, 1848.59, 1768.61, 936, 1177.35, 798.544, 1252.85, 2253.3, 24144.7, 952.646, 26746.3, 831.24, 1201.72, 1680.68, 1118.33, 897.683, 8823.43, 4775.3, 1187.17, 1204.31, 1976.36, 1637.45, 5972.4, 1880.52, 1158.88, 1469.82, 1904.76, 1760.41, 925.771, 8896.34, 1673.44, 7999.41, 1023.26, 1538.8, 1706.65, 2352.69, 2851.3, 9998.93, 5545.47, 1046.99, 1558.06, 1441.97, 1986.73, 1851.84, 2121.9, 8001.51, 2209.64, 995.13, 2915.83, 1981.85, 2486.71, 1066.74, 1422.65, 1246.67, 1086.97, 1796.87, 1782.44, 1815.81, 1004.6, 10322.6, 1532.01, 2288.48, 880.694, 2716.48, 1457.41, 1443.43, 3744.94, 1095.35, 1906.04, 2063.02, 2311.94, 11935.2, 2228.38, 2114.51, 3130.5, 1121.47, 1140.39, 11379.7, 1545.29, 5392.64, 3165.7, 1189.93, 3095.93, 3290.51, 2350.54, 2374.93, 1283.18, 1461.52, 3178.23, 1458.64, 3117.34, 3120.41, 2436.99, 2351.87, 3121.19, 3077.62, 2892.58, 1393.16, 1194.51, 1916.34, 1655.03, 1318.17, 1342.09, 1963.34, 4335.29, 1177.27, 7178.79, 3809.42, 1164.41, 1925.51, 1821.71, 3584.47, 1340.77, 4522.69, 4765.19, 3006.17, 2057.94, 6918.76, 2726.99, 1479.26, 1390.43, 3534.26, 1359.26, 1784.84, 2311.93, 2015.71, 1514.48, 2492.09, 1365.26, 6506.04, 2814.35, 1341.89, 1489.65, 4368.21, 1921.99, 2398.91, 1859.78, 1338.16, 2055.42, 1567.63, 2841.33, 1495.16, 1542.02, 3827.51, 1567.47, 2407.42, 1308.93, 1850.63, 1383.64, 3331.51, 1440.59, 1340.32, 1964.3, 3440.49, 2032.42, 4202.76, 4956.56, 2677.83, 1452.08, 4657.84, 1813.21, 2238.9, 5186.25, 1369.9, 2058.98, 2447.15, 2445.95, 4661.98, 5608.37, 6729.18, 1803.8, 2016.48, 2051.61, 6085.18, 5445.72, 4870.43, 2085.88, 2158.55, 9430.5, 1712.55, 3684.6, 1661.99, 8232.51, 4909.89, 1912.16, 2279.56, 5744.36, 2443.23, 9886.85, 2181.4, 4426.26, 4720.59, 5866.66, 4737.94, 6079.82, 2473.08, 4602.39, 2645.54, 2177.96, 4907.37, 4313.06, 8586.28, 5469.02, 4961.02, 6430.15, 2068.94, 3116.36, 1967.02, 6705.41, 2144.35, 10562.4, 4369.85, 2405.21, 6399.97, 2848.83, 2626.65, 2860.64, 2768.01, 5139.89, 3175.03, 9445.02, 2571.14, 9004.99, 9204.11, 2251.36, 6824.28, 9468.74, 3909.51, 6784.26, 7260.13, 3207.56, 8240.22, 3867.58, 10539.6, 3533.61, 3374.86, 3931.17, 2801.47, 4488.65, 2854.64, 8053.58, 3580.77, 8900.43, 3537.02, 3219.07, 4382.62, 4046.15, 3870.84, 3487.29, 3471.18, 4205.9, 3596.69, 12414.4, 4626.16, 4491.35, 4113.72, 5285.35, 4272.78, 13263.5, 5079.67, 15258.6, 16239.2, 7380.04, 5714.52, 9591.65, 9018.48, 9866.07, 6496.76, 9145.63, 12931.2, 12623.8,]

x=[404.32, 405.405, 405.47, 407.585, 407.615, 408.04, 408.235, 408.31, 409.15, 409.965, 410.385, 410.69, 412.515, 413.195, 413.445, 413.52, 413.865, 414.3, 414.485, 415.315, 415.62, 416.26, 416.825, 417.4, 417.93, 418.5, 419.075, 419.65, 420.225, 420.805, 421.38, 421.955, 422.535, 423.11, 423.685, 424.265, 424.84, 425.415, 425.995, 426.57, 427.145, 427.725, 428.3, 428.875, 429.455, 430.03, 430.605, 431.185, 431.76, 432.34, 432.915, 433.49, 434.07, 434.645, 435.22, 435.8, 436.375, 436.95, 437.53, 438.105, 438.68, 439.26, 439.835, 440.41, 440.99, 441.565, 442.14, 442.72, 443.295, 443.87, 444.45, 445.025, 445.605, 446.18, 446.755, 447.335, 447.91, 448.49, 449.065, 449.64, 450.215, 450.795, 451.37, 451.945, 452.525, 453.1, 453.675, 454.255, 454.83, 455.405, 455.985, 456.56, 457.135, 457.715, 458.305, 458.87, 459.455, 460.02, 460.605, 461.19, 461.75, 462.33, 462.905, 463.48, 464.06, 464.635, 465.215, 465.805, 466.365, 466.965, 467.52, 468.105, 468.705, 469.25, 469.835, 470.405, 470.99, 471.565, 472.135, 472.73, 473.31, 473.87, 474.445, 475.03, 475.615, 476.175, 476.745, 477.335, 477.925, 478.475, 479.07, 479.645, 480.205, 480.8, 481.365, 481.97, 482.53, 483.105, 483.7, 484.32, 484.825, 485.41, 486.035, 486.59, 487.135, 487.725, 488.295, 488.9, 489.455, 490.035, 490.685, 491.195, 491.75, 492.4, 492.95, 493.495, 494.05, 494.65, 495.23, 495.815, 496.46, 496.99, 497.54, 498.095, 498.69, 499.27, 499.82, 500.4, 500.98, 501.585, 502.15, 502.7, 503.305, 503.89, 504.525, 505.015, 505.69, 506.175, 506.92, 507.32, 507.97, 508.465, 509.09, 509.64, 510.255, 510.86, 511.365, 512.075, 512.665, 513.125, 513.86, 514.275, 514.81, 515.63, 516.02, 516.57, 517.26, 517.78, 518.305, 518.87, 519.44, 520.045, 520.835, 521.25, 522.005, 522.485, 522.925, 523.675, 524.535, 524.69, 525.27, 525.94, 526.74, 527.495, 527.5, 528.1, 528.675, 529.405, 529.85, 530.535, 531.19, 531.54, 532.44, 532.95, 533.285, 534.285, 534.545, 535, 535.595, 536.28, 536.735, 537.32, 537.895, 538.73, 539.175, 540.17, 541.015, 541.185, 541.58, 541.985, 542.535, 543.39, 543.87, 544.47, 544.875, 545.435, 546.49, 546.55, 547.325, 547.76, 548.64, 549.485, 549.535, 550.16, 550.885, 551.46, 551.995, 552.495, 553.09, 554.035, 554.285, 555.61, 555.75, 555.905, 556.395, 556.99, 557.73, 558.155, 558.885, 559.335, 559.9, 560.375, 561.075, 562.265, 562.33, 563.225, 563.425, 564.83, 564.86, 565, 566.095, 566.585, 567.595, 567.61, 567.95, 568.56, 569.56, 570.655, 570.69, 571.415, 572.035, 572.47, 573.17, 573.71, 574.285, 574.48, 575.82, 575.85, 576.205, 577.415, 577.505, 577.8, 578.835, 579.6, 581.11, 581.59, 581.835, 582.43, 582.45, 582.49, 583.11, 584.82, 585.155, 585.315, 585.465, 585.805, 586.855, 587.25, 587.83, 588.485, 588.75, 590.98, 591.025, 591.035, 591.07, 591.99, 592.915, 593.28, 593.585, 594.94, 595.015, 595.64, 596.095, 597.945, 598.5, 599.165, 600.055, 600.39, 600.57, 600.725, 600.905, 601.005, 601.57, 602.57, 602.685, 604.745, 605.04, 605.41, 605.825, 605.84, 606, 606.835, 607.16, 607.805, 608.355, 609.885, 610.45, 611.05, 611.125, 611.295, 611.93, 612.76, 613.005, 614.965, 615.565, 619.18, 619.985, 620, 620.25, 620.4, 621.65, 623.86, 624.09, 624.515, 625.535, 625.78, 626.435, 627.89, 628.365, 628.55, 629.42, 629.95, 630.485, 631.84, 632.855, 633.86, 635.135, 635.29, 635.37, 635.505, 636.165, 636.445, 636.8, 641.4, 642.8, 643.755, 644.64, 645.04, 645.225, 645.44, 645.815, 646.5, 646.75, 646.945, 646.99, 647.375, 648.51, 648.86, 648.975, 650.26, 654.875, 654.925, 655.09, 655.62, 656.01, 656.45, 658.14, 658.6, 662.405, 662.585, 665.34, 666.175, 666.315, 667.32, 670.485, 670.665, 671.675, 671.82, 674.385, 674.595, 676.435, 678.205, 680.485, 682.765, 685.435, 685.625, 686.18, 687.385, 689.23, 689.78, 690.455, 690.71, 695.32, 696.18, 696.38, 696.59, 696.855, 698.705, 702.065, 703.69, 703.97, 705.345, 705.78, 706.55, 709.83, 710.09, 710.865, 713.78, 713.97, 714.545, 716.75, 718.95, 719.26, 722.93, 725.45, 729.565, 730.63, 733.325, 738.35, 747.63, 754.27, 755.015, 760.94, 762.195, 765.015, 765.17, 768.865, 770.865, 773.5, 775.905, 777.7, 781.94, 784.405, 791.565, 794.19, 796.2, 814.7, 819.375, 824.435, 834.045, 836.58, 837.525, 838.375, 844.44, 857.165, 860.425, 864.55, 873.34, 874.695, 889.655, 903.6, 910.54, 911.25, 918.08, 924.205, 931.095, 954.46, 956.19, 967.28, 976.11, 1010.53, 1012.94, 1016.24, 1030.37, 1053.03, 1115.05, 1162.13, 1217.96, 1235.89, 1237.95, 1311.09, 1342.69, 1410.18, 1421.11, 1557.55,]

plot.scatter(x,y)
x1 = np.linspace(np.min(x), np.max(x))
y1 = 6.67452 * x1 + -2520.01#(Covariance minimization)
y2 = 7.26225 * x1 + -3219.1#(Weighted fit of lowes 10 points, half of the set used for each run)
y3 = 7.78047 * x1 + -3687.86#(lowest points from each interval, linear fit over random number of points between 5 and 10)
y4 = 3.81668 * x1 + -1428.42#(real RANSAC)
y5 = 4.3054 * x1 + -1634.3#(real RANSAC with weighted fit instead of linear fit)
y6 = 6.17729 * x1+ -2447.22#(linear fit of 8 randomly selected points)


plot.plot(x1,y1,label='Fit I')
plot.plot(x1,y2, label = 'Fit II')
plot.plot(x1,y3, label='Fit III')
plot.plot(x1, y4, label = 'Fit IV')
plot.plot(x1, y5, label = 'Fit V')
plot.plot(x1, y6, label = 'Fit VI')

plot.legend()
plot.xlabel("mean intensities", fontsize=15)
plot.ylabel("variance", fontsize=15)
plot.tick_params(axis='both', labelsize=12)
plot.legend(loc = 2, prop={'size':15})
dx = np.max(x)-np.min(x)
plot.axis([np.min(x)-0.1*dx, np.max(x)+0.1*dx, np.min(y)-1000, 30000])
plot.savefig('/home/herrmannsdoerfer/MasterArbeit/pictures/geradenplots/pos2red.png', dpi=300)