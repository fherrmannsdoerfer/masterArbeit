import numpy as np
import matplotlib.pyplot as plot

x=[407.72, 408.625, 409.775, 411.4, 412.515, 413.94, 416.365, 417.18, 418.045, 419.49, 420.88, 422.99, 423.515, 425.02, 426.285, 427.73, 429.98, 430.405, 432.31, 433.225, 434.845, 436.33, 437.26, 438.66, 440.02, 441.39, 442.765, 444.14, 445.515, 446.89, 448.265, 449.64, 451.015, 452.39, 453.765, 455.14, 456.515, 457.89, 459.265, 460.64, 462.015, 463.39, 464.765, 466.14, 467.515, 468.895, 470.27, 471.645, 473.02, 474.395, 475.77, 477.145, 478.52, 479.895, 481.27, 482.645, 484.02, 485.395, 486.77, 488.15, 489.52, 490.905, 492.275, 493.645, 495.025, 496.395, 497.77, 499.145, 500.525, 501.9, 503.285, 504.65, 506.025, 507.405, 508.79, 510.15, 511.53, 512.9, 514.3, 515.66, 517.04, 518.41, 519.78, 521.15, 522.53, 523.905, 525.28, 526.66, 528.025, 529.405, 530.82, 532.155, 533.53, 534.985, 536.28, 537.66, 539.055, 540.405, 541.815, 543.155, 544.55, 545.925, 547.315, 548.72, 550.035, 551.44, 552.855, 554.155, 555.545, 557.035, 558.285, 559.69, 561.085, 562.525, 563.845, 565.22, 566.565, 567.945, 569.4, 570.695, 572.045, 573.43, 574.895, 576.175, 577.635, 578.935, 580.335, 581.935, 583.035, 584.415, 585.79, 587.2, 588.535, 589.985, 591.525, 592.775, 594.045, 595.705, 596.83, 598.175, 599.61, 601.03, 602.385, 603.69, 605.165, 606.515, 607.995, 609.185, 610.76, 612.165, 613.36, 614.775, 616.095, 617.91, 619.03, 620.38, 621.77, 623.135, 624.39, 625.825, 627.15, 628.67, 629.895, 631.23, 632.7, 634.04, 635.295, 636.735, 638.105, 639.47, 640.8, 642.535, 643.98, 644.98, 646.32, 647.815, 649.24, 650.66, 651.93, 653.21, 654.705, 656.19, 657.505, 658.78, 660.12, 661.605, 663.57, 664.725, 665.6, 667.535, 668.405, 670.09, 671.085, 672.49, 674.31, 675.24, 676.65, 678.59, 679.615, 681.49, 682.55, 684.115, 684.95, 686.19, 687.96, 689.56, 690.43, 692.01, 693.47, 694.57, 695.85, 697.4, 699.01, 700.145, 701.635, 703.04, 705.335, 705.44, 706.835, 708.345, 710.795, 714.315, 714.375, 714.43, 715.275, 716.89, 717.88, 719.27, 720.765, 723.305, 724.7, 725.27, 726.51, 727.5, 728.965, 731.65, 732.7, 733.065, 734.525, 735.805, 739.055, 739.665, 740.29, 743.255, 743.605, 744.325, 750.71, 751.195, 753.205, 754.56, 756.365, 757.73, 759.085, 763.03, 763.795, 766.705, 768.775, 770.72, 771.055, 771.265, 771.455, 771.55, 772.15, 773.185, 773.205, 774.86, 775.875, 780.01, 780.035, 783.135, 783.76, 786.565, 789.255, 789.52, 793.61, 795.825, 797.53, 797.85, 801.455, 802.015, 802.155, 803.885, 804.46, 806.875, 807.575, 808.45, 808.655, 815.91, 817.815, 820.75, 821.035, 822.53, 824.31, 824.68, 825.025, 827.195, 829.75, 839.59, 840.725, 841.01, 844.78, 848.27, 851.085, 851.84, 855.19, 856.815, 859.425, 865.49, 866.31, 869.265, 871.25, 873.03, 874.725, 874.855, 876.44, 878.51, 882.545, 886.49, 926.125, 926.165, 930.66, 935.655, 935.985, 936.02, 936.62, 937.605, 943.61, 947.305, 947.685, 954.86, 962.01, 975.935, 978.45, 983.055, 985.755, 987.515, 989.335, 1000.54, 1001.26, 1005.29, 1007.6, 1008.11, 1013.57, 1014.74, 1015.41, 1016.54, 1016.75, 1018.83, 1021.28, 1022.28, 1040.96, 1048.47, 1050.97, 1055.39, 1066.11, 1076.88, 1081.32, 1084.12, 1097.35, 1108.83, 1110.34, 1115.56, 1118.85, 1121.45, 1126.29, 1140.56, 1155.94, 1170.36, 1195.86, 1225.73, 1234.59, 1240.23, 1266.5, 1274.34, 1284.2, 1302.44, 1339.85, 1342.55, 1344.03, 1348.69, 1357.36, 1385.1, 1398.06, 1407.79, 1418.84, 1450.29, 1478.91, 1482.33, 1484.44, 1509.62, 1525.97, 1812.83, 1834.57, 1838.11, 1863.94, 1894.44, 1932.47, 1951.55, 1983.56, 1984.77, 2020.28, 2057.17, 2127.38, 2155.31, 2241.86, 2249.29, 2335.4, 2421.84, 2484.61, 2580.11, 2791.91, 2919.24, 2921.2, 2958.76, 3045.09, 3125.06, 3126.84, 3157.45]

y=[185.191, 188.023, 197.618, 184.532, 154.064, 202.138, 185.606, 214.114, 243.46, 239.95, 177.431, 225.593, 236.788, 248.022, 226.425, 322.798, 248.389, 277.776, 255.09, 251.6, 283.32, 294.507, 362.627, 287.602, 314.698, 255.749, 301.035, 376.125, 391.067, 291.626, 325.983, 340.734, 340.551, 354.785, 401.251, 442.968, 374.683, 420.424, 445.336, 481.191, 392.741, 439.349, 350.417, 480.551, 516.896, 421.771, 588.414, 518.395, 429.929, 948.073, 676.656, 518.824, 427.994, 593.554, 526.481, 421.919, 828.459, 670.165, 468.492, 483.52, 555.773, 2387.8, 401.12, 325.555, 595.799, 840.959, 543.16, 664.257, 613.909, 1847.73, 692.554, 623.201, 789.195, 1098.13, 798.739, 755.191, 5565.02, 675.281, 586.739, 821.739, 1945.19, 800.435, 1411.89, 1473.57, 992.651, 1089.49, 1448.04, 631.899, 574.034, 1809.68, 1247.25, 2221.17, 859.818, 1504.45, 1181.21, 2654.87, 6298.15, 6364.73, 1067.07, 5318.11, 901.016, 3350.44, 2204.53, 661.567, 9133.67, 1605.21, 17896.6, 4813.12, 4182.36, 2431.95, 5429.83, 2310.08, 4803.98, 13554.9, 2419.36, 12174.4, 26502, 6439.39, 19117.1, 10088.7, 2054.67, 11892, 6269.36, 15089.6, 3854.32, 1832.85, 12168, 6693.98, 2027.91, 2052.56, 11028, 2563.33, 2152.31, 3495.56, 12459.4, 22884.9, 1080.95, 2839.09, 13616.2, 29304.1, 30198.3, 12511.4, 946.87, 1451.99, 1128.93, 45539.8, 37331.9, 28188.7, 20300.1, 12797, 38007, 3872, 1034.31, 48930.8, 28455.6, 4308.52, 24204.5, 20872, 13182.8, 8486.75, 7623.49, 29257.9, 1542.94, 30495.2, 10981.1, 29150.8, 10191.7, 25715.8, 1304.18, 21333.3, 39407.5, 63927.8, 26331, 1166.32, 34167.1, 15077, 50035.5, 59235.2, 37565.3, 1472, 32965, 35634.3, 57218.6, 16732.7, 36942.3, 14367.1, 13950.9, 37236, 9105.62, 47704.2, 61269.2, 37965.4, 11924.9, 7165.98, 52266, 67844.7, 27872.3, 1523.41, 41515.3, 13696.9, 60880.5, 77088.6, 51087.1, 17001.3, 42470.4, 38347.5, 55713.3, 21787.6, 77255.7, 44512.9, 46430.3, 1306.75, 48605, 88246, 27081.6, 61188.2, 73084.9, 71150.4, 20286.1, 25354, 69328.5, 38282.7, 43727.1, 1844.15, 29219.6, 66912.8, 48737.6, 1430.89, 63467.7, 33795, 4040.62, 42290.1, 8667.43, 44259.7, 1848.58, 23855.2, 1649.49, 63056.1, 13702, 67738.1, 73847.9, 81738.7, 12747.8, 57844.9, 1915.33, 53860, 50035.1, 26965.7, 97052.2, 1878.43, 67644.2, 2145.75, 6249.98, 43171.8, 33020.7, 3035.32, 98269.4, 81234.3, 1753.9, 4545.47, 1729.77, 37370.5, 6247.7, 1630.33, 88804, 1654.04, 67891.6, 47725.8, 1761.96, 2101.54, 1490.9, 1778.59, 21271.1, 70111.2, 1682.33, 69169.2, 75858.3, 37019.3, 2727.87, 2315.3, 1816.85, 2008.87, 2538.83, 2181.31, 2493.97, 19529.3, 1766.6, 6613.45, 86538.6, 2372.18, 1818.7, 89283.2, 89962.5, 2186.25, 11367.5, 37642.4, 2294.06, 2049.57, 47726.4, 39746, 103988, 2186.73, 2358.5, 51973.1, 58406.3, 2699.9, 2716.48, 3048.67, 2371.18, 2897.72, 112201, 2559.29, 8090.31, 61043.5, 3773.41, 2566.85, 55458.2, 20229.3, 2804.53, 2761.94, 3219.69, 2707.2, 2923.68, 3462.7, 3806.73, 2629.89, 3191.93, 3101.02, 2897.66, 52319.9, 3068.62, 40321.1, 52142.6, 3293.41, 2698.93, 50525.9, 3511.38, 2661.28, 3669.54, 2940.47, 3522.85, 3156.34, 3691.01, 3663.71, 30816.4, 2973.72, 2963.92, 4111.14, 3945.39, 3619.49, 61405.8, 3901.58, 3269.12, 60829.6, 3705.63, 4102.12, 3891.52, 4085.12, 4171.62, 4104.87, 2893.6, 4494.85, 3331.34, 56657.3, 3651.72, 4238.44, 4974.95, 3574.4, 4764.08, 5157.03, 5006.56, 4811.66, 4298.94, 4689.27, 6238.11, 6608.71, 5233.46, 5751.15, 5996.83, 5702.41, 5091.45, 8973.12, 6865.31, 6465.15, 5448.98, 6453.8, 5823.52, 5361.42, 7762.08, 7231.71, 5476.63, 8250.52, 8562.09, 7272.94, 8340.93, 10611.5, 11949.1, 7922.37, 9912.65, 10918, 11338.5, 7951.7, 9809.58, 9288.65, 9972.83, 15142.1, 10659.7, 10471.5, 15525.9, 11558, 18467.8, 10932.3, 15380, 15333.3, 15069.9, 14646.1, 13441.4, 13491.2]

s2 = 12.9
c2 = -364*13

col = []
for xn, yn in zip(x,y):
    if yn-(xn*s2+c2)<0:
        col.append([1,0,0])
    else:
        col.append([0,0,1])

x1 = np.linspace(np.min(x),np.max(x),1000)
y1 = 5.31193*x1-364.723*5.31193
#plot.plot(x,np.asarray(x)*s2+c2)

plot.scatter(x,y,color=col)
plot.scatter(665,22035,color=[0,0,1], label = 'blinking pixels')
plot.scatter(2559,14279,color=[1,0,0], label = 'constant pixels')
plot.plot(x1,y1,color=[0.5,0,0.5], linewidth = 2, label='fitted line')
a = plot.gca()
a.set_aspect(0.45*(np.max(x)-np.min(x))/(np.max(y)-np.min(y)))
plot.title("Bleaching signal", fontsize=20)
plot.xlabel("Frame", fontsize=20)
plot.ylabel("Mean background intensity", fontsize=20)
plot.tick_params(axis='both', labelsize=15)
plot.legend()
plot.legend(loc = 0, prop={'size':15})
plot.axis([380,3200,-2500,116000])
plot.show()
#plot.savefig('/home/herrmannsdoerfer/MasterArbeit/pictures/skellamPlot.png')

